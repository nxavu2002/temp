from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
from selenium.webdriver.common.action_chains import ActionChains
from selenium.webdriver.chrome.options import Options
import undetected_chromedriver as uc

import time
import json
import os
import shutil
import urllib.request
import requests
from zenrows import ZenRowsClient

client = ZenRowsClient("651070fa5d2475988f14ac1e96eddea0b02c3b8b")
opener=urllib.request.build_opener()
opener.addheaders=[('User-Agent','Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/36.0.1941.0 Safari/537.36')]
urllib.request.install_opener(opener)
driver = uc.Chrome()
data = []
image_data = []

typeRealEstate = [
    { "value": "1", "label": "Căn hộ chung cư" , "link": "https://batdongsan.com.vn/cho-thue-can-ho-chung-cu", "links":['https://batdongsan.com.vn/cho-thue-can-ho-chung-cu-duong-xa-lo-ha-noi-phuong-an-phu-prj-lumiere-riverside/mr-hieu-quan-ly-c-1pn-2otr-2pn-24tr-3pn-35tr-mien-phi-quan-ly-xem-nha-ngay-pr38582357', 'https://batdongsan.com.vn/cho-thue-can-ho-chung-cu-pho-ton-duc-thang-phuong-ben-nghe-prj-vinhomes-golden-river-ba-son/cap-nhat-gio-hang-c-moi-nhat-tai-vinmes-t12-2022-pr36155038', 'https://batdongsan.com.vn/cho-thue-can-ho-chung-cu-duong-xa-lo-ha-noi-phuong-an-phu-prj-lumiere-riverside/c-2pn-tang-dep-tu-27tr-th-lh-pr38729463', 'https://batdongsan.com.vn/cho-thue-can-ho-chung-cu-duong-nguyen-huu-tho-phuong-tan-hung-14-prj-sunrise-city/chuyen-c-quan-li-nhieu-1pn-13tr-2pn-18tr-3-4pn-23-30tr-pr34431823', 'https://batdongsan.com.vn/cho-thue-can-ho-chung-cu-pho-ton-duc-thang-phuong-ben-nghe-prj-vinhomes-golden-river-ba-son/nam-toan-bo-c-1-2-3-4pn-vinmes-quan-1-tro-tieng-anh-tieng-nhat-pr38824816', 'https://batdongsan.com.vn/cho-thue-can-ho-chung-cu-duong-xa-lo-ha-noi-phuong-an-phu-prj-lumiere-riverside/chay-gio-hang-1-2-3-phong-ngu-da-dang-dien-tich-hinh-that-gia-that-xem-nha-ngay-pr38822649', 'https://batdongsan.com.vn/cho-thue-can-ho-chung-cu-duong-xa-lo-ha-noi-phuong-an-phu-prj-lumiere-riverside/chinh-chu-cho-1pn-tang-dep-view-dep-chi-tu-15-trieu-th-pr38457962', 'https://batdongsan.com.vn/cho-thue-can-ho-chung-cu-duong-nguyen-huu-tho-phuong-tan-hung-14-prj-sunrise-city/nhieu-giam-gia-sock-1pn-13tr-2pn-16tr-3pn-21tr-pr39139046', 'https://batdongsan.com.vn/cho-thue-can-ho-chung-cu-duong-nguyen-huu-tho-phuong-tan-hung-14-prj-sunrise-city/c-100-dai-han-ngan-han-1pn-10tr-2pn-14tr-3pn-18tr-pr38430824', 'https://batdongsan.com.vn/cho-thue-can-ho-chung-cu-pho-ton-duc-thang-phuong-ben-nghe-prj-vinhomes-golden-river-ba-son/c-vinmes-bason-158m2-4pn-toa-aqua-view-truc-dien-song-tang-cao-pr29110839', 'https://batdongsan.com.vn/cho-thue-can-ho-chung-cu-duong-nguyen-xien-phuong-long-thanh-my-prj-vinhomes-grand-park/chuyen-c-vinmes-q9-2pn-5tr-3pn-8tr-an-ninh-dang-cap-voi-day-du-tien-ich-pr32394246', 'https://batdongsan.com.vn/cho-thue-can-ho-chung-cu-duong-nguyen-xien-phuong-long-thanh-my-prj-vinhomes-grand-park/chuyen-c-vinmes-quan-9-gia-re-chi-tu-3-8tr-thang-lh-0902000922-pr34114001', 'https://batdongsan.com.vn/cho-thue-can-ho-chung-cu-phuong-long-thanh-my-prj-vinhomes-grand-park/cap-nhat-gio-hang-c-vinmes-moi-nhat-16-02-2024-pr39105369', 'https://batdongsan.com.vn/cho-thue-can-ho-chung-cu-phuong-long-thanh-my-prj-vinhomes-grand-park/ngo-ngang-voi-gia-c-tot-nhat-thi-truong-studio-1pn-2pn-3pn-pr37056189', 'https://batdongsan.com.vn/cho-thue-can-ho-chung-cu-xa-duong-xa-prj-vinhomes-ocean-park-gia-lam/c-dep-re-nhat-thi-truong-chi-tu-4tr-th-studio-1pn-2pn-3pn-vao-o-duoc-luon-pr39205894', 'https://batdongsan.com.vn/cho-thue-can-ho-chung-cu-duong-dien-bien-phu-phuong-22-prj-vinhomes-central-park/chuyen-c-vinmes-gia-tot-nhat-thi-truong-1-2-3-4pn-lh-pr38754674', 'https://batdongsan.com.vn/cho-thue-can-ho-chung-cu-pho-ton-duc-thang-phuong-ben-nghe-prj-vinhomes-golden-river-ba-son/chuyen-c-vinmes-bason-1-2-3-4-pn-gia-tot-nhat-tt-lh-xem-nha-0902762707-pr32384211', 'https://batdongsan.com.vn/cho-thue-can-ho-chung-cu-duong-nguyen-van-linh-phuong-tan-thuan-tay-1-prj-eco-green-sai-gon/chuyen-quan-ly-c-sg-q7-2pn-70m2-gia-12tr-th-xem-nha-24-7-lh-0899121989-pr35670559', 'https://batdongsan.com.vn/cho-thue-can-ho-chung-cu-duong-vo-van-kiet-phuong-an-lac-6-prj-akari-city-nam-long/c-cao-cap-56m2-6-5tr-thang-pr39194008', 'https://batdongsan.com.vn/cho-thue-can-ho-chung-cu-phuong-tay-mo-prj-masteri-west-heights/c-studio-1pn-2pn-va-3pn-gia-tot-nhat-masterise-pr38953962']},
    { "value": "2", "label": "Nhà riêng" , "link": "https://batdongsan.com.vn/cho-thue-nha-rieng", "links": ['https://batdongsan.com.vn/cho-thue-nha-rieng-duong-to-vinh-dien-phuong-6_3/cho-khu-dan-cu-cao-cap-lam-homestay-pr39184459', 'https://batdongsan.com.vn/cho-thue-nha-rieng-duong-bui-thi-xuan-phuong-2-22/cho-mat-tien-nguyen-can-24-2-tan-binh-100m2-san-1-tret-1-lau-pr32017281', 'https://batdongsan.com.vn/cho-thue-nha-rieng-duong-7-phuong-an-lac-a/cho-pho-le-2-pn-duoi-10-trieu-khu-ten-lua-pr38675389', 'https://batdongsan.com.vn/cho-thue-nha-rieng-duong-hoang-hoa-tham-phuong-5-16/cho-nguyen-can-hxh-47m2-4-tang-trung-tam-quan-phu-nhuan-pr39096613', 'https://batdongsan.com.vn/cho-thue-nha-rieng-duong-pham-van-dong-phuong-xuan-dinh/cho-ca-dt-san-150m2-7-tang-thang-may-mat-tien-8-5m2-o-to-2-chieu-pr39169699', 'https://batdongsan.com.vn/cho-thue-nha-rieng-duong-au-co-phuong-kinh-bac/cho-chinh-chu-4-tang-9-phong-tong-dien-tich-324m2-pr39165026', 'https://batdongsan.com.vn/cho-thue-nha-rieng-pho-phuong-mai-phuong-phuong-mai/cho-tai-so-24-46-duong-dong-da-hn-pr39150783', 'https://batdongsan.com.vn/cho-thue-nha-rieng-duong-nguyen-thi-nho-phuong-14-2/cho-can-trung-tam-q5-1-tret-2-lau-1-san-thuong-4pn-3wc-gia-17tr-thang-pr39160071', 'https://batdongsan.com.vn/cho-thue-nha-rieng-duong-thong-nhat-phuong-11-8/toi-chinh-chu-can-cho-tang-tret-lau-1-so-371-11-go-vap-pr39152384', 'https://batdongsan.com.vn/cho-thue-nha-rieng-duong-giai-phong-phuong-thinh-liet/chinh-chu-cho-so-12-mat-ngo-1197-rong-2-o-to-tranh-u-thoai-mai-pr39139407', 'https://batdongsan.com.vn/cho-thue-nha-rieng-duong-le-hong-phong-phuong-phu-hoa/cho-tien-nghi-gan-truong-dai-hoc-thanh-pho-thu-dau-mot-pr37993602', 'https://batdongsan.com.vn/cho-thue-nha-rieng-duong-huynh-van-nghe-phuong-phu-loi/-nguyen-can-2pn-can-cho-khu-dan-tri-an-ninh-cao-gia-tot-pr38905366', 'https://batdongsan.com.vn/cho-thue-nha-rieng-duong-duong-quang-ham-phuong-5-15/cho-can-hem-xe-hoi-114-p5-go-vap-pr39214326', 'https://batdongsan.com.vn/cho-thue-nha-rieng-duong-cach-mang-thang-tam-phuong-11-1/cho-nguyen-can-cmt8-q3-40m2-hem-thong-3m-doi-dien-cho-hoa-hung-40m-8tr-pr39195669', 'https://batdongsan.com.vn/cho-thue-nha-rieng-duong-do-xuan-hop-phuong-phuoc-long-b/cho-cap-4-kdc-kien-a-lien-quan-9-pr39214353', 'https://batdongsan.com.vn/cho-thue-nha-rieng-duong-hung-vuong-2-xa-phu-dong-2/can-cho-mat-tien-tien-o-kinh-doanh-buon-ban-pr39210120', 'https://batdongsan.com.vn/cho-thue-nha-rieng-duong-138-phuong-tan-phu-12/cho-uu-tien-gia-dinh-pr39213511', 'https://batdongsan.com.vn/cho-thue-nha-rieng-duong-32-thi-tran-tram-troi/chinh-chu-cho-gan-khu-do-nam-32-hd-ha-noi-2-tang-dt-220m2-gia-10tr-thg-lh-pr38744718', 'https://batdongsan.com.vn/cho-thue-nha-rieng-xa-cu-khe/chinh-chu-can-cho-thon-thuong-thanh-oai-hn-pr38629058', 'https://batdongsan.com.vn/cho-thue-nha-rieng-phuong-tan-hung-14-prj-khu-do-thi-him-lam-kenh-te/cho-pho-5x20-himlam-ham-tret-3-lau-moi-gia-35tr-thang-lh-0901364394-pr37827390']},
    { "value": "3", "label": "Biệt thự" , "link": "https://batdongsan.com.vn/cho-thue-nha-biet-thu-lien-ke", "links": ['https://batdongsan.com.vn/cho-thue-nha-biet-thu-lien-ke-duong-to-huu-phuong-van-phuc-1-prj-tsq-galaxy/cho-kdt-ha-dong-dt-91m2-6-tang-full-dieu-hoa-thang-may-khe-thoang-pr39082620', 'https://batdongsan.com.vn/cho-thue-nha-biet-thu-lien-ke-duong-quoc-lo-13-phuong-hiep-binh-phuoc-prj-jamona-home-resort/-re-nhat-13-gia-re-nhat-cho-khach-he-trong-t02-2024-pr39174484', 'https://batdongsan.com.vn/cho-thue-nha-biet-thu-lien-ke-duong-phuoc-huu-phuong-phuoc-long-b-prj-valora-fuji/chinh-chu-cho-villa-duc-169m2-4pn-pr39081791', 'https://batdongsan.com.vn/cho-thue-nha-biet-thu-lien-ke-duong-nguyen-van-loc-phuong-mo-lao-prj-lang-viet-kieu-chau-au-euroland/cho-mat-kinh-doanh-hang-pr39139660', 'https://batdongsan.com.vn/cho-thue-nha-biet-thu-lien-ke-duong-duong-dinh-nghe-phuong-yen-hoa-2/chuyen-nhuong-hang-khu-btlk-sau-toa-mobifone-pvi-dt100m2-gia-chi-30tr-pr38963234', 'https://batdongsan.com.vn/cho-thue-nha-biet-thu-lien-ke-xa-van-canh-1/chinh-chu-cho-hoai-duc-pr39177870', 'https://batdongsan.com.vn/cho-thue-nha-biet-thu-lien-ke-duong-song-hanh-phuong-an-phu-prj-khu-do-thi-lakeview-city/cho-pho-full-noi-that-gia-25tr-35tr-thang-view-cong-vien-ntcb-28tr-thang-pr39212339', 'https://batdongsan.com.vn/cho-thue-nha-biet-thu-lien-ke-xa-duong-xa-prj-vinhomes-ocean-park-gia-lam/cho-gap-full-do-song-lap-35tr-va-full-do-25tr-oceanpark-1-pr39181702', 'https://batdongsan.com.vn/cho-thue-nha-biet-thu-lien-ke-phuong-vinh-niem-prj-vinhomes-marina-cau-rao-2/cho-90m2-chinh-chu-vinmarina-2-hai-phong-pr39209421', 'https://batdongsan.com.vn/cho-thue-nha-biet-thu-lien-ke-duong-le-trong-tan-phuong-duong-noi-prj-khu-do-thi-geleximco-le-trong-tan/cho-geximco-dt-100-120-160m2-gia-tot-nhat-truong-pr37228775', 'https://batdongsan.com.vn/cho-thue-nha-biet-thu-lien-ke-duong-le-trong-tan-phuong-duong-noi-prj-khu-do-thi-geleximco-le-trong-tan/chinh-chu-cho-60m2-truc-chinh-20-5m-hoan-thien-co-ban-gia-13tr-thang-pr38881636', 'https://batdongsan.com.vn/cho-thue-nha-biet-thu-lien-ke-phuong-phuc-loi-prj-vinhomes-riverside/chinh-chu-cho-song-lap-don-lap-tai-long-bien-200-2000m2-pr39207937', 'https://batdongsan.com.vn/cho-thue-nha-biet-thu-lien-ke-duong-44a-thi-tran-phuoc-hai-2-prj-oceanami-luxury-homes-and-resort/cho-3-phong-ngu-b3-6-tai-ocenami-pr39205655', 'https://batdongsan.com.vn/cho-thue-nha-biet-thu-lien-ke-duong-le-trong-tan-xa-an-khanh-4-prj-khu-a-geleximco-le-trong-tan/-hon-thien-gi-tot-nht-thi-truong-pr39172070', 'https://batdongsan.com.vn/cho-thue-nha-biet-thu-lien-ke-duong-nguyen-huu-tho-xa-phuoc-kieng-prj-lavila-kien-a-nha-be/cho-cn-ho-hu-dep-t-dt-6x17-6-view-song-tom-tret-2-lu-3pn-full-nt-pr39202343', 'https://batdongsan.com.vn/cho-thue-nha-biet-thu-lien-ke-duong-ly-thai-to-phuong-hoa-phu-2-prj-midori-park/cho-pho-haruka-vi-tri-dac-dia-gia-ca-hap-dan-pr39198294', 'https://batdongsan.com.vn/cho-thue-nha-biet-thu-lien-ke-duong-le-trong-tan-xa-an-khanh-4-prj-khu-a-geleximco-le-trong-tan/cho-gip-vinhomes-smrt-city-pr39197371', 'https://batdongsan.com.vn/cho-thue-nha-biet-thu-lien-ke-xa-phuoc-thuan-prj-ixora-ho-tram/c-villa-by-fusion-pr39194499', 'https://batdongsan.com.vn/cho-thue-nha-biet-thu-lien-ke-duong-lac-long-quan-phuong-phu-thuong-1-prj-khu-do-thi-nam-thang-long-ciputra/cho-goc-nhieu-anh-sang-vi-tri-dep-tai-t-ciputra-pr38785858', 'https://batdongsan.com.vn/cho-thue-nha-biet-thu-lien-ke-xa-duong-xa-prj-vinhomes-ocean-park-gia-lam/chinh-chu-cho-can-sb02-27-da-hoan-thien-3-5-tang-23tr-bao-phi-dich-vu-pr39192676']},
    { "value": "4", "label": "Nhà mặt phố" , "link": "https://batdongsan.com.vn/cho-thue-nha-mat-pho", "links": ['https://batdongsan.com.vn/cho-thue-nha-mat-pho-pho-chua-lang-phuong-lang-thuong/chinh-chu-cho-tai-vi-tri-kinh-doanh-dac-dia-so-dep-pr39165700', 'https://batdongsan.com.vn/cho-thue-nha-mat-pho-duong-minh-khai-phuong-minh-khai/cho-tien-o-171-hai-ba-trung-dt-70m2-x-7-tang-130-trieu-thang-pr39114944', 'https://batdongsan.com.vn/cho-thue-nha-mat-pho-duong-duong-dinh-hoi-phuong-phuoc-long-b-1/cho-tien-cach-do-xuan-hop-50-met-gan-nga-4-binh-thai-spa-van-phong-pr38744650', 'https://batdongsan.com.vn/cho-thue-nha-mat-pho-duong-lang-yen-phuong-thanh-luong/-tien-8m-dien-tich-200m-1-san-pr39208054', 'https://batdongsan.com.vn/cho-thue-nha-mat-pho-duong-21e-phuong-binh-tri-dong-b/cho-nguyen-can-tien-8-5m-pr38857046', 'https://batdongsan.com.vn/cho-thue-nha-mat-pho-duong-lang-phuong-nga-tu-so/cho-345m2-01-san-cuc-thuan-loi-kinh-doanh-tai-dong-da-ha-noi-pr38450183', 'https://batdongsan.com.vn/cho-thue-nha-mat-pho-duong-le-van-thinh-phuong-cat-lai/chinh-chu-can-cho-gap-p-q2-dt-286m2-11mx26m-lh-pr39192963', 'https://batdongsan.com.vn/cho-thue-nha-mat-pho-duong-nguyen-hoang-phuong-my-dinh-2/cho-can-so-9-so-cu-268-tien-rong-9-5-m-3-tang-tong-dt-500m2-pr39192065', 'https://batdongsan.com.vn/cho-thue-nha-mat-pho-duong-tay-son-phuong-quang-trung/chinh-chu-cho-3-tang-mt-3-5m-thuan-tien-kinh-doanh-buon-ban-pr39176064', 'https://batdongsan.com.vn/cho-thue-nha-mat-pho-phuong-nghia-do-1/cho-bang-kinh-doanh-lam-cua-hang-trung-bay-san-pham-showroom-van-phong-lam-viec-pr39177789', 'https://batdongsan.com.vn/cho-thue-nha-mat-pho-duong-le-van-hien-phuong-hoa-hai/cho-khach-san-the-shine-hotel-ngu-hanh-son-da-nang-dang-kd-tot-pr39175549', 'https://batdongsan.com.vn/cho-thue-nha-mat-pho-duong-nguyen-van-linh-phuong-du-hang-kenh/chinh-chu-cho-755-3-tang-thong-san-hien-trang-dep-co-thang-may-pr39175569', 'https://batdongsan.com.vn/cho-thue-nha-mat-pho-duong-58-phuong-dong-phong/cho-shoowroom-200m2-cao-2-tang-xay-kien-co-lam-hang-lam-garaoto-deu-duoc-pr39174563', 'https://batdongsan.com.vn/cho-thue-nha-mat-pho-duong-den-lu-phuong-hoang-van-thu-4/-view-ho-chinh-chu-cho-de-xe-rat-dep-pr39170296', 'https://batdongsan.com.vn/cho-thue-nha-mat-pho-duong-luong-ngoc-quyen-phuong-phan-dinh-phung-2/chinh-chu-cho-thai-nguyen-phu-hop-kinh-doanh-lam-van-ng-pr39167302', 'https://batdongsan.com.vn/cho-thue-nha-mat-pho-duong-ky-con-phuong-nguyen-thai-binh/chinh-chu-cho-bang-114-q1-gia-25-trieu-thang-tien-kd-va-lam-vp-ngang-3m-dai-9m-pr39166348', 'https://batdongsan.com.vn/cho-thue-nha-mat-pho-duong-nguyen-hoang-phuong-vinh-trung/cho-chinh-chu-can-tien-2-tang-so-338-p-trung-pr39166145', 'https://batdongsan.com.vn/cho-thue-nha-mat-pho-duong-truong-sa-phuong-2-21/cho-nguyen-can-mt-dt-sd-120-m2-pr38073838', 'https://batdongsan.com.vn/cho-thue-nha-mat-pho-duong-le-loi-1-phuong-nguyen-trai-4/chu-can-cho-gap-tang-1-2-dt-50m2-tien-kd-moi-nganh-nghe-pr39142427', 'https://batdongsan.com.vn/cho-thue-nha-mat-pho-duong-nguyen-van-linh-phuong-vinh-trung/cho-bang-tien-khu-sam-uat-gan-bank-mua-sam-pr38521357']},
    { "value": "5", "label": "Nhà trọ phòng trọ" , "link": "https://batdongsan.com.vn/cho-thue-nha-tro-phong-tro", "links": ['https://batdongsan.com.vn/cho-thue-nha-tro-phong-tro-pho-tran-dai-nghia-phuong-dong-tam/cho-ccmn-40m2-khep-kin-full-do-thang-may-gan-truong-ktqd-7tr-thang-pr38852601', 'https://batdongsan.com.vn/cho-thue-nha-tro-phong-tro-duong-nguyen-duy-trinh-phuong-phu-huu-2/cho-day-du-giuong-tu-ti-vi-may-lanh-bep-tu-dt-20m2-gia-1-3-trieu-hinh-that-100-pr38743418', 'https://batdongsan.com.vn/cho-thue-nha-tro-phong-tro-duong-huynh-van-nghe-phuong-15-8/chinh-chu-cho-dt-18-20m2-wc-rieng-du-do-chi-viec-den-o-gia-re-pr37081721', 'https://batdongsan.com.vn/cho-thue-nha-tro-phong-tro-duong-minh-khai-phuong-minh-khai/cho-chung-cu-mini-moi-noi-that-day-du-khu-vuc-an-ninh-vao-o-luon-lh-pr39205630', 'https://batdongsan.com.vn/cho-thue-nha-tro-phong-tro-duong-duong-ba-trac-phuong-1-17/cho-ky-tuc-xa-cao-cap-o-1-quan-8-pr38512526', 'https://batdongsan.com.vn/cho-thue-nha-tro-phong-tro-duong-le-trong-tan-phuong-tay-thanh/sleep-box-cao-cap-full-noi-that-tien-nghi-gia-sinh-vien-phu-pr39141263', 'https://batdongsan.com.vn/cho-thue-nha-tro-phong-tro-duong-cach-mang-thang-tam-phuong-11-1/kenh-sai-gon-cho-rat-rong-o-dai-han-gia-re-pr39128802', 'https://batdongsan.com.vn/cho-thue-nha-tro-phong-tro-duong-tan-nhue-phuong-thuy-phuong_2/cho-moi-tinh-gan-hvtc-mo-ytcc-dong-co-ecohome-pr39185685', 'https://batdongsan.com.vn/cho-thue-nha-tro-phong-tro-phuong-tan-phong-9/-cao-cap-quan-7-cho-gia-binh-dan-nhung-noi-that-day-du-khong-o-chung-voi-chu-nha-pr16697609', 'https://batdongsan.com.vn/cho-thue-nha-tro-phong-tro-pho-ba-trieu-phuong-trang-tien/chinh-chu-cho-gan-ho-guom-pr39174580', 'https://batdongsan.com.vn/cho-thue-nha-tro-phong-tro-duong-de-tham-phuong-cau-ong-lanh/cho-day-du-noi-that-co-ban-moi-gia-tot-pr39051577', 'https://batdongsan.com.vn/cho-thue-nha-tro-phong-tro-duong-thanh-thai-phuong-12-5/cho-dep-cao-cap-du-tien-nghi-trung-tam-q10-436-19-3-thang-2-va-43-3-thai-pr13310352', 'https://batdongsan.com.vn/cho-thue-nha-tro-phong-tro-duong-lac-long-quan-phuong-xuan-la/cho-can-ho-vip-khep-kin-moi-day-du-noi-that-tai-tay-ho-pr38011496', 'https://batdongsan.com.vn/cho-thue-nha-tro-phong-tro-duong-hong-ha-phuong-chuong-duong/cho-chung-cu-mini-tai-hoan-kiem-day-du-noi-tt-pr38923304', 'https://batdongsan.com.vn/cho-thue-nha-tro-phong-tro-duong-phu-do-phuong-phu-do/cho-can-ho-60m2-moi-xay-ngo-87-nam-tu-liem-pr38201286', 'https://batdongsan.com.vn/cho-thue-nha-tro-phong-tro-duong-vo-van-hat_1-phuong-long-truong/-sach-se-can-ho-tiet-kiem-ma-gia-nhu-pr39126079', 'https://batdongsan.com.vn/cho-thue-nha-tro-phong-tro-duong-binh-loi-phuong-13-7/chinh-chu-cho-cao-cap-32m2-toa-66-13-p-13-q-thanh-pr37836008', 'https://batdongsan.com.vn/cho-thue-nha-tro-phong-tro-duong-pham-van-chieu-phuong-14-8/cho-trong-nguyen-can-co-bancon-full-noi-that-14-go-vap-pr39214932', 'https://batdongsan.com.vn/cho-thue-nha-tro-phong-tro-duong-binh-loi-phuong-13-7/khai-truong-gia-re-cho-sinh-vien-o-duoc-4-nguoi-4-xe-gan-dh-van-lang-3-va-cau-loi-pr39195922', 'https://batdongsan.com.vn/cho-thue-nha-tro-phong-tro-duong-nguyen-minh-hoang-phuong-12-10/cho-dep-thoang-mat-gan-lotte-cong-hoa-tan-binh-35m2-gan-cong-vien-khu-k300-pr39212508']},
    { "value": "6", "label": "Shop house" , "link": "https://batdongsan.com.vn/cho-thue-shophouse-nha-pho-thuong-mai", "links": ['https://batdongsan.com.vn/cho-thue-shophouse-nha-pho-thuong-mai-phuong-an-phu-prj-the-global-city/deal-shock-cho-tho-lk4-3-chi-68tr-cdt-cho-80-100tr-pr39204783', 'https://batdongsan.com.vn/cho-thue-shophouse-nha-pho-thuong-mai-duong-phan-van-tri-phuong-10-8-prj-cityland-park-hills/cho-khoi-de-tai-go-vap-chinh-chu-group-pr38606340', 'https://batdongsan.com.vn/cho-thue-shophouse-nha-pho-thuong-mai-duong-cuu-viet-thi-tran-trau-quy/cho-4-tang-gia-re-t-khu-vuc-moi-tinh-day-du-tien-ich-dia-diem-kinh-doanh-tot-pr39213368', 'https://batdongsan.com.vn/cho-thue-shophouse-nha-pho-thuong-mai-duong-nguyen-xien-phuong-dai-kim-prj-the-manor-central-park/chinh-chu-cho-can-dap-thong-150m2-3-mat-tien-tai-du-an-park-pr39199963', 'https://batdongsan.com.vn/cho-thue-shophouse-nha-pho-thuong-mai-phuong-tay-mo-prj-masteri-west-heights/cho-chan-de-toa-a-du-an-can-tmdv05-lh-pr39192641', 'https://batdongsan.com.vn/cho-thue-shophouse-nha-pho-thuong-mai-duong-tran-phu-thi-tran-thuong-tin-prj-him-lam-thuong-tin/cho-cc-da-nang-mat-truong-hoc-hang-ca-phe-hieu-sach-gia-tot-t-pr39135519', 'https://batdongsan.com.vn/cho-thue-shophouse-nha-pho-thuong-mai-pho-tran-dai-nghia-phuong-tan-tao-a-prj-vision-binh-tan/cho-tttm-chung-cu-khach-hang-tuong-lai-hon-2000-can-ho-pr39172335', 'https://batdongsan.com.vn/cho-thue-shophouse-nha-pho-thuong-mai-xa-nghia-tru-prj-mega-grand-world-ha-noi/cho-shop-k-town-mien-phi-2-nam-ho-tro-voucher-10tr-thang-3-thang-pr39092722', 'https://batdongsan.com.vn/cho-thue-shophouse-nha-pho-thuong-mai-duong-song-hanh-phuong-an-phu-prj-khu-do-thi-lakeview-city/-gia-tot-t-full-noi-that-gia-25tr-can-goc-san-vuon-gia-28tr-lh-pr39117294', 'https://batdongsan.com.vn/cho-thue-shophouse-nha-pho-thuong-mai-duong-70-2-phuong-tay-mo-prj-vinhomes-smart-city/quy-can-shop-chan-de-cho-city-pr39197440', 'https://batdongsan.com.vn/cho-thue-shophouse-nha-pho-thuong-mai-phuong-lai-thieu-prj-the-seasons-lai-thieu/chinh-chu-can-cho-can-2-mat-tien-tai-trung-tam-tp-thuan-an-binh-duong-pr38485872', 'https://batdongsan.com.vn/cho-thue-shophouse-nha-pho-thuong-mai-xa-duong-xa-prj-vinhomes-ocean-park-gia-lam/cho-khu-hai-au-hoan-thien-ca-3-phong-ngu-full-noi-that-co-thang-may-chi-30-trieu-pr39184434', 'https://batdongsan.com.vn/cho-thue-shophouse-nha-pho-thuong-mai-xa-duong-xa-prj-vinhomes-ocean-park-gia-lam/quy-tong-hop-300-can-cho-biet-thu-lien-ke-1-ha-noi-pr39131721', 'https://batdongsan.com.vn/cho-thue-shophouse-nha-pho-thuong-mai-duong-quoc-lo-13-phuong-hiep-binh-phuoc-prj-khu-do-thi-van-phuc-city/cho-nguyen-can-mat-tien-shophoue-truc-kinh-anh-da-nghanh-nghe-phuc-pr39174892', 'https://batdongsan.com.vn/cho-thue-shophouse-nha-pho-thuong-mai-duong-n1-phuong-son-ky-prj-celadon-city/mat-bang-cho-dien-tich-150m2-300m2-trong-khu-dan-cu-cao-cap-quan-tan-phu-sat-aeon-pr37028953', 'https://batdongsan.com.vn/cho-thue-shophouse-nha-pho-thuong-mai-duong-51-phuong-an-phu-prj-the-sun-avenue/chinh-chu-cho-70m2-mt-51-khu-sam-uat-24-7-chi-30tr-thag-pr39172665', 'https://batdongsan.com.vn/cho-thue-shophouse-nha-pho-thuong-mai-phuong-long-thanh-my-prj-vinhomes-grand-park/-cho-nhieu-kinh-doanh-gia-tu-15tr-thang-lh-0933-777-844-pr39048353', 'https://batdongsan.com.vn/cho-thue-shophouse-nha-pho-thuong-mai-xa-nghia-tru-prj-mega-grand-world-ha-noi/mien-phi-tien-2-nam-khu-k-town-grandworld-kinh-doanh-24-7-pr38897758', 'https://batdongsan.com.vn/cho-thue-shophouse-nha-pho-thuong-mai-xa-nghia-tru-prj-mega-grand-world-ha-noi/chinh-sach-cho-tot-nhat-thi-truong-mien-phi-2-nam-tang-goi-that-va-voucher-mua-sam-pr38949252', 'https://batdongsan.com.vn/cho-thue-shophouse-nha-pho-thuong-mai-xa-nghia-tru-prj-mega-grand-world-ha-noi/ktown-word-uu-dai-khung-cho-khach-som-pr38889358']},
    { "value": "7", "label": "Văn phòng" , "link": "https://batdongsan.com.vn/cho-thue-van-phong", "links": ['https://batdongsan.com.vn/cho-thue-van-phong-duong-nguyen-hue-phuong-ben-nghe/24-01-2019-vp-cho-quan-1-20m2-2000m2-220-nghin-m2-18006310-mien-cuoc-0902738229-zalo-pr6028192', 'https://batdongsan.com.vn/cho-thue-van-phong-pho-thi-sach-phuong-ben-nghe/-mat-bang-trong-cho-tai-q1-uu-dai-gia-hap-dan-chi-voi-600-000d-m2-pr39112713', 'https://batdongsan.com.vn/cho-thue-van-phong-duong-duc-dien-phuong-phuc-dien/-sieu-pham-moi-xay-tich-len-den-1-000m2-pr39170626', 'https://batdongsan.com.vn/cho-thue-van-phong-duong-cong-hoa-phuong-13-10/cho-nguyen-can-toa-nha-mat-tien-13-quan-tan-binh-tp-hcm-pr39166622', 'https://batdongsan.com.vn/cho-thue-van-phong-pho-giang-vo-phuong-cat-linh/cho-mbkd-san-tai-vo-pr39131323', 'https://batdongsan.com.vn/cho-thue-van-phong-duong-yen-the-phuong-2-22/chinh-chu-cho-mat-bang-lau-tret-va-lau-1-tai-uu-tien-cho-lam-showroom-pr39062065', 'https://batdongsan.com.vn/cho-thue-van-phong-duong-dien-bien-phu-phuong-da-kao/sgr-building-cho-quan-1-view-dep-gia-uu-dai-pr38337767', 'https://batdongsan.com.vn/cho-thue-van-phong-duong-cach-mang-thang-tam-phuong-ben-thanh/cho-gia-re-quan-1-pr37999916', 'https://batdongsan.com.vn/cho-thue-van-phong-pho-phuong-liet-phuong-phuong-liet/cho-cua-hang-pr39050841', 'https://batdongsan.com.vn/cho-thue-van-phong-duong-le-thi-trung-phuong-phu-loi/cho-mat-bang-kinh-doanh-va-cong-ty-pr38790138', 'https://batdongsan.com.vn/cho-thue-van-phong-duong-lac-long-quan-phuong-buoi/toi-cho-nha-8-tang-1-ham-dt-150m2-san-hoac-cho-le-tai-mat-pho-tay-ho-hn-pr39203936', 'https://batdongsan.com.vn/cho-thue-van-phong-duong-nguyen-thai-hoc-thi-tran-phung/chinh-chu-cho-mat-tien-lon-gia-re-ngay-dan-phuong-ha-noi-he-rong-4m-ql12-cu-gia-tl-pr39203487', 'https://batdongsan.com.vn/cho-thue-van-phong-pho-tran-binh-phuong-my-dinh-2-prj-my-dinh-plaza/cho-141m2-gia-re-tai-toa-binh-pr39202766', 'https://batdongsan.com.vn/cho-thue-van-phong-duong-quang-trung-phuong-8-12/cc-cho-toa-moi-100-hien-dai-tai-752-8-quan-go-vap-pr39202342', 'https://batdongsan.com.vn/cho-thue-van-phong-duong-dien-bien-phu-phuong-1-20/24-01-2019-vp-cho-binh-thanh-200-nghin-m2-20-2000m2-18006310-mien-cuoc-0902738229-zalo-pr6602693', 'https://batdongsan.com.vn/cho-thue-van-phong-duong-cong-hoa-phuong-13-10/24-01-2019-vp-cho-tan-binh-160-nghin-m2-20m2-2000m2-18006310-mien-cuoc-0902738229-zalo-pr4957818', 'https://batdongsan.com.vn/cho-thue-van-phong-pho-tran-quy-kien-phuong-dich-vong/cho-mat-san-kinh-doanh-90m2-san-pr36248671', 'https://batdongsan.com.vn/cho-thue-van-phong-duong-tran-dang-ninh-phuong-dich-vong-prj-kdt-lang-quoc-te-thang-long/cho-tang-9-thap-tay-toa-hancorp-plaza-72-quan-cau-giay-pr39184710', 'https://batdongsan.com.vn/cho-thue-van-phong-duong-duy-tan-phuong-dich-vong-hau-prj-viet-a-tower/cho-full-noi-tht-tien-ich-gi-re-view-dep-ti-to-nh-cu-giy-h-noi-pr39084315', 'https://batdongsan.com.vn/cho-thue-van-phong-duong-81-phuong-tan-quy/-cho-quan-7-nhieu-dien-tich-dep-pr39105574']},
]

for item in typeRealEstate:
  roomvalue = item["value"]
  roomlabel = item["label"]
  for link in item["links"]:
    driver.get(link)
    name_element = driver.find_element(By.XPATH, '//h1[@class="re__pr-title pr-title js__pr-title"]')
    print(name_element.text)
    address_element = driver.find_element(By.XPATH, '//span[@class="re__pr-short-description js__pr-address"]')
    print(address_element.text)
    description_element = driver.find_element(By.XPATH, '//div[@class="re__section-body re__detail-content js__section-body js__pr-description js__tracking"]')
    print(description_element.text)
    coordinates = driver.find_element(By.CLASS_NAME, 're__section-body.js__section-body iframe').get_attribute("data-src")
    coordinates = coordinates.split("?q=", 1)[1].split("&key", 1)[0].split(",", 1)
    spec_items = driver.find_elements(By.CLASS_NAME, 're__pr-specs-content-item')
    property_data = {}

    image_element = driver.find_elements(By.XPATH, '//li[@class="swiper-slide js__media-item-container"]//div[@class="re__overlay js__overlay"]//img')
    for image_div in image_element[1:]:
      image_src = image_div.get_attribute("data-src")
      image_name = image_src.split("/")[-1]
      directory_path = os.path.join('media')
      os.makedirs(directory_path, exist_ok=True)
      image_path = os.path.join(directory_path, image_name)
      response = client.get(image_src)
      if response.status_code == 200:
          with open(image_path, 'wb') as f:
              f.write(response.content)
              print("successfully.")
      else:
          print("Failed")
    temp = {
      "name": "",
      "links": {},
    }
    temp["name"] = name_element.text
    for i, img in enumerate(image_element, start=1):
      src = img.get_attribute("data-src")
      temp["links"][str(i)] = src
    image_data.append(temp)

    for item in spec_items:
        title_element = item.find_element(By.XPATH, './/span[@class="re__pr-specs-content-item-title"]')
        value_element = item.find_element(By.XPATH, './/span[@class="re__pr-specs-content-item-value"]')
        if hasattr(title_element, 'text') and  hasattr(value_element, 'text') :
          title = title_element.text
          value = value_element.text
          print(title, value)
          if title == "Diện tích":
            property_data["acreage"] = value
          elif title == "Mức giá":
            property_data["cost"] = value
          elif title == "Số tầng":
            property_data["floorTotal"] = value
          elif title == "Số phòng ngủ":
            property_data["bedroomTotal"] = value
          elif title == "Số toilet":
            property_data["toiletTotal"] = value
          elif title == "Nội thất":
            property_data["isInterior"] = True if len(value)>0 else False
    item_data = {
        "name": name_element.text,
        "address": {
            "name": address_element.text,
            "lat": coordinates[0],
            "lng": coordinates[1]
        },
        "cost": property_data.get("cost", ""),
        "description": description_element.text,
        "acreage": property_data.get("acreage", ""),
        "floorTotal": property_data.get("floorTotal", ""),
        "bedroomTotal": property_data.get("bedroomTotal", ""),
        "isPet": True,
        "autoPayment": True,
        "isPaymentCoin": True,
        "facade": 0,
        "isInterior": property_data.get("isInterior", False),
        "toiletTotal": property_data.get("toiletTotal", ""),
        "directionHouse": "",
        "status": "1",
        "type": roomvalue,
    }
    data.append(item_data)
json_data = json.dumps(data, indent=4, ensure_ascii=False)
json_imgdata = json.dumps(image_data, indent=4, ensure_ascii=False)
with open('data.json', 'w', encoding="utf-8") as json_file:
    json_file.write(json_data)
with open('image_link.json', 'w', encoding="utf-8") as json_file:
    json_file.write(json_imgdata)
driver.close()
